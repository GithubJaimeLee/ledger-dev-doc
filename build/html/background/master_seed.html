

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>The Master Seed &mdash; Ledger Documentation Hub 2 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="HD Key Generation" href="hd_keys.html" />
    <link rel="prev" title="Personal Security Devices" href="personal_security_devices.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Ledger Documentation Hub
          

          
          </a>

          
            
            
              <div class="version">
                2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Background Information</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="personal_security_devices.html">Personal Security Devices</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Master Seed</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#generation-and-serialization">Generation and Serialization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hd_keys.html">HD Key Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="hd_use_cases.html">Applications of HD Trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="application_isolation.html">Application Isolation</a></li>
</ul>
<p class="caption"><span class="caption-text">BOLOS Platform</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../bolos/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bolos/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bolos/features.html">BOLOS Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bolos/hardware_architecture.html">Hardware Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bolos/application_environment.html">Application Environment</a></li>
</ul>
<p class="caption"><span class="caption-text">Userspace Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userspace/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace/setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace/writing_apps.html">Writing Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace/display_management.html">Display Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace/advanced_display_management.html">Advanced Display Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace/syscalls.html">Interaction Between BOLOS and Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace/application_structure.html">Application Structure and I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace/memory.html">Persistent Storage and PIC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace/alignment.html">Memory alignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace/troubleshooting.html">Common Pitfalls and Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace/debugging.html">Application Debug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace/speculos.html">Emulating devices with Speculos</a></li>
</ul>
<p class="caption"><span class="caption-text">Additional Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../additional/publishing_an_app.html">Publishing an Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../additional/external_docs.html">External Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../additional/security_guidelines.html">Developing Secure Ledger Apps</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Ledger Documentation Hub</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>The Master Seed</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/background/master_seed.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-master-seed">
<h1>The Master Seed<a class="headerlink" href="#the-master-seed" title="Permalink to this headline">¶</a></h1>
<p>Applications running on Ledger <a class="reference internal" href="personal_security_devices.html"><span class="doc">personal security devices</span></a> are designed to be lightweight and easily
recoverable. Ledger achieves both of these goals by using <strong>hierarchical
deterministic key generation</strong>. Hierarchical deterministic key generation is
used by applications to derive a theoretically infinite number of cryptographic
secrets from a single master seed. In this way, your cryptocurrency private
keys, passwords, and other cryptographic secrets can all be determined and
intrinsically “stored” in a single master seed. Because of this, the device’s
apps don’t have to store their own private keys, because they can all be
generated on-demand by the device from the master seed. This means that if your
device is lost, destroyed, or reset then all you need is your master seed to
recover your secrets. In addition, an application that supports this scheme can
be deleted and reinstalled without losing any secure data or assets. Your master
seed is randomly generated for you when you first set up your Ledger device, and
then you just need to write it down to allow you to recover your device in the
future.</p>
<div class="section" id="generation-and-serialization">
<h2>Generation and Serialization<a class="headerlink" href="#generation-and-serialization" title="Permalink to this headline">¶</a></h2>
<p>The master seed is the key to your cryptographic secrets. As such, the master
seed should be something that is long and nearly impossible for anyone to guess.
Your master seed isn’t like a password or a PIN (Ledger devices already have
PINs to protect access to them), instead it’s the root of all of your
cryptographic secrets. You only need to access it when you first write it down
on paper when your device randomly generates it for the first time, or in the
future if you have to recover your device.</p>
<p>Ledger uses a standard called <a class="reference external" href="https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki">BIP 39</a> for the
generation and interpretation of the master seed on all of our devices. BIP 39
is an industry standard used by many other hierarchical deterministic wallets.
The exact type of BIP 39 seed used by Ledger devices by default is a 24-word
mnemonic that consists of only the 2048 words from the <a class="reference external" href="https://github.com/bitcoin/bips/blob/master/bip-0039/english.txt">BIP 39 English wordlist</a>. Here’s how
a BIP 39 24-word mnemonic seed is generated:</p>
<ol class="arabic simple">
<li><p>The device generates a sequence of 256 random bits using the true random
number generator (TRNG) built into the device’s Secure Element.</p></li>
<li><p>The first 8 bits of the SHA-256 hash of the initial 256 bits is appended to
the end, giving us 264 bits.</p></li>
<li><p>All 264 bits are split into 24 groups of 11 bits.</p></li>
<li><p>Each group of 11 bits is interpreted as a number in the range 0 - 2047, which
serves as an index to the BIP 39 wordlist, giving us 24 words.</p></li>
</ol>
<p>The result of this process is that your device will generate a single mnemonic
seed out of 2<sup>256</sup> possible mnemonic seeds (That’s one of 115 792 089 237
316 195 423 570 985 008 687 907 853 269 984 665 640 564 039 457 584 007 913 129
639 936 possible mnemonic seeds). Note that while the first 23 words are
completely random, the final word was derived from 3 random bits and 8
calculated bits from the SHA-256 hash. This means that the final word can act
like a checksum - if you input an incorrect seed into the device while
recovering it, it is possible for the device to detect that the inputted seed is
invalid.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Can someone guess my seed?</strong> There are 2<sup>256</sup> different possible
24-word mnemonic seeds. For comparison, the number of atoms on Earth is
estimated to be around 2<sup>166</sup>. Just let that sink in for a second. The
chance of someone else being able to guess your seed is astronomically small,
to say the least.</p>
</div>
<p>But all we have here is a sequence of 24 words, how can the device use this as a
cryptographic secret?</p>
<p>After the 24-word mnemonic is generated, it has to be converted into a binary
seed by the device (this process is called serialization). This is done using
the PBKDF2-HMAC-SHA512 key derivation function to convert your mnemonic seed
<strong>and an optional passphrase of your choosing</strong> into a 512 bit binary seed. This
BIP 39 passphrase can be <a class="reference external" href="https://support.ledger.com/hc/en-us/articles/115005214529">set on your device</a>
through the Settings menu, and it can be changed at will without resetting your
device (in fact, you can have multiple passphrases loaded onto the device at
once if you wish). By changing the passphrase, the resulting 512 bit binary seed
is completely changed.</p>
<p>This 512 bit binary seed is the root of your device’s cryptographic secrets.
Every cryptographic secret that your device needs (cryptocurrency private keys &amp;
addresses, passwords, etc.) can be derived from this 512 bit binary seed. We’ll
explore how an infinite number of cryptographic secrets can be derived from this
one seed in the next section, <a class="reference internal" href="hd_keys.html"><span class="doc">HD Key Generation</span></a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="hd_keys.html" class="btn btn-neutral float-right" title="HD Key Generation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="personal_security_devices.html" class="btn btn-neutral float-left" title="Personal Security Devices" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2016 - 2019, Ledger Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>